# Agent-Friendliness Report: wa (wezterm_automata)

**Bead ID**: bd-o6r (re-underwriting)
**Date**: 2026-01-25
**Agent**: Claude Opus 4.5

## Executive Summary

**Status: EXCELLENT AGENT-FRIENDLINESS MATURITY**

wa is highly optimized for AI coding agent terminal automation:
- Full `robot` subcommand with stable JSON envelope
- Comprehensive robot commands for terminal control
- JSON schema documentation
- Comprehensive AGENTS.md documentation (10KB)

## 1. Current State Assessment

### 1.1 Robot Mode Support

| Feature | Status | Details |
|---------|--------|---------|
| `robot` subcommand | YES | Full robot mode with JSON envelope |
| JSON envelope | YES | `ok`, `data`, `error`, `error_code`, `hint`, `elapsed_ms` |
| `--format` flag | NO | Planned for TOON integration |
| `WA_OUTPUT_FORMAT` env | YES | Existing format control |
| JSON schemas | YES | `docs/json-schema/wa-robot-*.json` |

### 1.2 Robot Commands

| Command | Purpose |
|---------|---------|
| `robot help` | List available commands |
| `robot quick-start` | Quick start guide (default) |
| `robot state` | Get pane states |
| `robot get-text <pane>` | Get text from pane |
| `robot send <pane> <text>` | Send text to pane |
| `robot wait-for <pane> <pattern>` | Wait for pattern |
| `robot search <query>` | Search across panes |
| `robot events` | Get recent events |
| `robot workflow run/list/status/abort` | Workflow management |
| `robot why <code>` | Explain error codes |
| `robot approve <code>` | Approve dangerous operations |

### 1.3 Output Structure (RobotResponse envelope)

```json
{
  "ok": true,
  "data": { ... },
  "error": null,
  "error_code": null,
  "hint": null,
  "elapsed_ms": 42,
  "version": "0.1.0",
  "now": "2026-01-25T16:00:00Z"
}
```

### 1.4 Unique Features

- **dry-run support**: `robot send --dry-run` for preview
- **wait-for patterns**: Regex pattern matching
- **workflow system**: Multi-step automation
- **approval codes**: Safety for dangerous operations

## 2. Documentation Assessment

### 2.1 AGENTS.md

**Status**: EXISTS and comprehensive (10KB)

Contains:
- Rule 1: Absolute file deletion protection
- Rust toolchain guidelines
- Robot mode API documentation
- Workflow system patterns

### 2.2 Additional Documentation

- README.md: 18KB user guide
- RESEARCH_FINDINGS.md: 6KB TOON integration analysis
- PLAN.md: 165KB detailed implementation plan
- `docs/json-schema/`: Full JSON schemas

## 3. Scorecard

| Dimension | Score (1-5) | Notes |
|-----------|-------------|-------|
| Documentation | 5 | AGENTS.md + JSON schemas |
| CLI Ergonomics | 5 | Clear robot subcommand structure |
| Robot Mode | 5 | Full JSON envelope with metadata |
| Error Handling | 5 | error_code + hint fields |
| Consistency | 5 | Stable envelope across commands |
| Zero-shot Usability | 5 | quick-start + why commands |
| **Overall** | **5.0** | Exceptional maturity |

## 4. TOON Integration Status

**Status: PLANNED, NOT YET IMPLEMENTED**

From RESEARCH_FINDINGS.md:
- `--format toon` flag planned
- Two strategies: full envelope or data-only TOON
- Recommended: Keep envelope JSON, TOON-encode data field

## 5. Recommendations

### 5.1 High Priority (P1)

None - wa is already exceptionally agent-friendly

### 5.2 Medium Priority (P2)

1. Implement TOON integration
2. Sync JSON schemas with current Rust structs

### 5.3 Low Priority (P3)

1. Add streaming events output option
2. Document all error codes

## 6. Agent Usage Patterns

### Get Terminal State
```bash
wa robot state
```

### Send Commands to Pane
```bash
wa robot send 0 "ls -la"
```

### Wait for Output Pattern
```bash
wa robot wait-for 0 "Done"
```

### Dry-Run Preview
```bash
wa robot send 0 "rm -rf temp" --dry-run
```

### Explain Error Code
```bash
wa robot why E001
```

### Run Workflow
```bash
wa robot workflow run my-workflow
```

## 7. Unique Agent-Friendly Features

1. **Stable Envelope**: Consistent response structure
2. **Error Hints**: Actionable suggestions on failure
3. **Dry-Run**: Preview dangerous operations
4. **Approval Codes**: Safety gates for dangerous commands
5. **Elapsed Time**: Performance tracking

## 8. Conclusion

wa demonstrates exceptional agent-friendliness for terminal automation:
- Stable JSON envelope with rich metadata
- Comprehensive robot command set
- Safety features (dry-run, approval codes)
- Full JSON schema documentation

Score: **5.0/5** - Exceptional maturity for terminal automation.

---
*Generated by Claude Opus 4.5 during agent-friendly re-underwriting*
